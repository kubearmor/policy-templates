# KubeArmor is an open source software that enables you to protect your cloud workload at run-time.
# To learn more about KubeArmor visit: 
# https://www.accuknox.com/kubearmor/ 

apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: ksp-cve-2021-42013-path-traversal
  #namespace: default # Change your namespace
spec:
  tags: ["CVE","CWE-22","Path Traversal","CVE-2021-42013"]
  message: "Alert! Access to linux file is detected and blocked, Hence this blocked CVE-2021-42013"
  selector:
    matchLabels:
       app: apache-vuln # use your own labels
  file: 
    severity: 9
    matchDirectories:
    - dir: /bin/ 
      recursive: true                        
      ownerOnly: true   
    - dir: /dev/ 
      recursive: true                        
      ownerOnly: true 
    - dir: /home/ 
      recursive: true                         
      ownerOnly: true  
    - dir: /lib64/ 
      recursive: true                        
      ownerOnly: true  
    - dir: /mnt/ 
      recursive: true                        
      ownerOnly: true 
    - dir: /proc/ 
      recursive: true                        
      ownerOnly: true  
    - dir: /run/ 
      recursive: true                     
      ownerOnly: true  
    - dir: /srv/ 
      recursive: true                          
      ownerOnly: true 
    - dir: /tmp/ 
      recursive: true                          
      ownerOnly: true 
    - dir: /var/ 
      recursive: true                          
      ownerOnly: true 
    - dir: /boot/ 
      recursive: true                         
      ownerOnly: true 
    - dir: /etc/ 
      recursive: true                         
      ownerOnly: true 
    - dir: /lib/ 
      recursive: true                         
      ownerOnly: true 
    - dir: /media/ 
      recursive: true                          
      ownerOnly: true
    - dir: /root/ 
      recursive: true                         
      ownerOnly: true 
    - dir: /sbin/ 
      recursive: true                           
      ownerOnly: true 
    - dir: /sys/ 
      recursive: true                            
      ownerOnly: true 
    - dir: /usr/bin/ 
      recursive: true                       
      ownerOnly: true 
    - dir: /usr/sbin/
      recursive: true
    - dir: /opt/                     #please add all the directory,files which is not accessible through apache
      recursive: true                         
      ownerOnly: true   
      fromSource: 
      - path: /usr/local/apache2/bin/httpd
    action: Block
