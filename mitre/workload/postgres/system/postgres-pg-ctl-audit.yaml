apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: mitre-tactic-postgres-pgctl-cluster
spec:
  selector:
      matchLabels:
          {}
  process:
    matchPaths:
    - path: /usr/bin/pg_ctlcluster
    - path: /var/log/postgresql
    - path: /usr/lib/postgresql/13/bin/pg_ctl
      fromSource: # trigger an alert if the source
        - dir: /usr/
        - dir: /usr/lib/
        - dir: /var/log/
          recursive: true  
    severity: 5 # Higher severity 
  file:
    matchPaths: 
    - path: /usr/bin/pg_ctlcluster
    - path: /var/log/postgresql
    - path: /usr/lib/postgresql/13/bin/pg_ctl
      fromSource: # trigger an alert if the source
       - path: /usr
       - path: /lib
       - path: /var
    action: Audit
    severity: 9 # lowest severity
  tags : ["postgres","CVE-2016-1255"]