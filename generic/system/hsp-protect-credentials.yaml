apiVersion: security.kubearmor.com/v1
kind: KubeArmorHostPolicy
metadata:
  name: hsp-protect-credentials
spec:
  action: Audit
  # make block after testing
  #action: Block
  file:
    matchPaths:
    - path: /etc/passwd
      readOnly: true
    - path: /etc/shadow
      readOnly: true
    matchDirectories:
    - dir: /etc/pki/
      readOnly: true
      recursive: true
    - dir: /etc/ssl/
      readOnly: true
      recursive: true
    - dir: /usr/local/share/ca-certificates/
      readOnly: true
      recursive: true
    - dir: /root/.ssh/
      readOnly: true
      recursive: true
    - dir: /root/.ssh/.gnupg/
      readOnly: true
      recursive: true
  message: "ALERT! Blocked modification of credentials."
  nodeSelector:
    matchLabels:
      kubearmor.io/hostname: '*'
  severity: 5
  tags:
  - FGT1555
  - FIGHT
  - MITRE
  - MITRE_T1552_unsecured_credentials
