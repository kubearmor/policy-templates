# KubeArmor is an open source software that enables you to protect your cloud workload at run-time.
# To learn more about KubeArmor visit: 
# https://www.accuknox.com/kubearmor/ 

apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: ksp-postgresql-cve-2021-32029-unauthorized-modication-conf-file
  namespace: default
spec:
  tags: ["PostgreSQL", "configuration","postgresql", "CVE-2021-32029" ] 
  message: "Modification in Configuration file detected for PostgreSQL "
  selector:
    matchLabels:
      app: postgresql
  file:
    severity: 4
    matchPattern:
        - path: /var/lib/pgsql/*/data/postgresql.conf
        - path: /var/lib/pgsql/*/data/postgresql.auto.conf
        - path: /var/lib/pgsql/*/data/pg_hba.conf
        - path: /var/lib/pgsql/*/data/pg_ident.conf
        
    action: Audit
