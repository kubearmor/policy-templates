# KubeArmor is an open source software that enables you to protect your cloud workload at run-time.
# To learn more about KubeArmor visit:
# https://www.accuknox.com/kubearmor/

apiVersion: security.kubearmor.com/v1
kind: KubeArmorPolicy
metadata:
  name: ksp-audit-xorddos-process
  namespace: default
spec:
  tags: ["MALWARE", "XORDDOS"]
  message: "Alert! good binary detected possible xorddos malware"
  selector:
    matchLabels:
      container: xorddos
  process:
    severity: 1
    matchDirectories:
    - dir: /bin/
    - dir: /home/
    - dir: /root/
    - dir: /tmp/
    - dir: /usr/
    - dir: /etc/
    - dir: /boot/
    - dir: /lib/
    - dir: /var/run/
    matchPaths:
    - path: /usr/bin/good
    - path: /bin/good
    - path: /dev/null
    - path: /var/run/gcc.pid
    - path: /lib/libudev.so
    - path: /etc/cron.hourly/gcc.sh
    matchPatterns:
    - pattern: resolv.conf
    - pattern: /etc/rc*.d/*.elf
    - pattern: /etc/init.d/*.elf
    action: Audit
